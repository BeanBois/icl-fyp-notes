An introduction to factor graphs