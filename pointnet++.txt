PointNet++: Deep Hierarchical Feature Learning on Point Sets in a Metric Space

Introduction
    - Interested in analyzing geometric point sets which are collections of points in a Euclidean space
        > particularly, interested in point cloud captured by 3D scanners 
    - As a set, such data has to be invariant to permutations of its members 
    - Additionally, distance metric defines local neighborhoods that may exhibit different properties 
        > EG density and other attributes of points may not be uniform across different locations 
            - in 3D scanning, density variability can come from perspective effects, radial density varaition, motion ect
    - Basic idea of PointNet is to learn a spatial encoding of each point and then aggregate all individual point features to a global point cloud signature 
        > however, by design, PointNet does not capture local structure induced by the metric 
        > Exploiting local structure has proven to be important for the success of convolutional architectures
            - The ability to abstract local patterns along the hierarchy allows better generalizability to unseen cases 
    - PointNet++ is a hierarchical neural netowrk that processes a set of points sampled in a metric space in a hierarchical fashion 
    - General Idea of PointNet++ is simple:
        1: first partition set of points into overlapping local features capturing fine geometric structures from small neighborhoods
        2: these local features are further grouped into larger units and processed to produce higher level features 
        3: this is repeated unitl features of the whole point set is obtained 

    - Design of PointNet++ aims to address 2 issues:
        1: how to generate the partioning of the point set?
        2: how to abstract sets of points or local features through local feature learner 
        > these 2 issues are correlated bc the partitioning of the point set has to produce common structures across partitions
            - this is so that weights of local feature learners can be shared across partitions
        > PointNet is used as local feature learner as it is an effective architecture to process an unordered set of points for semantic feature extraction
            - it is also robust to input data corruption 
            - PointNet helps abstract sets of local points or features into higher level representations 
                > in this view, PointNet++ applies PointNet recursively on a nested partiioning of the input set
    - Issue of how to generate overlapping partitioning of a point set still remains 
        > Each partition is defined as a neighborhood ball in the underlying Euclidean space, whose parameters include centroid location and scale 
        > The centroids are selected among input point set by a farthest point sampling algo to ensure even coverage of whole set
        > Local receptive fields are dependent on both the input data and the metric, making it more efficient and effective 
    - Furthermore, deiciding the appropriate scale of local neighborhood balls is a more challenging problem (intriguing too!)
        > this is due to the entanglement of feature scale and non-uniformity of input point set 
            - input point set are assumed to potentially have variable density (common IRL) 
            - thus input point are different from CNN inputs which can be viewed as data defined on regular grids with uniform constant density 
                > a counterpart to local partition scale is the size of kernel in CNN
                > however, unlike in CNN where small kernel size can be effective, small neighborhod might not be effective for partitioning
                    - this may be due to sampling deficiency (non-uniformity of points), Causing PointNet to not be able to capture patterns robustly
Significant Contribution:
    - PointNet++ leverages neighborhoods at multiple scales to achieve both robustness and detail capture 
        > Assisted with random input dropout during training, the network learns to adaptively weight patterns detected at different scales 
        and combine multi-scale features according to input data
Problem Statement 
    - Suppose that X = (M,d) is a discrete metric space whose metric is inherited from a Euclidean space R^n
        > M is a subset of this Euc. space, or a set of points and d is the distance metric 
        > density of M is non-uniform 
    - we are inteterested in learning set functions f that take such X as the input and produce information of semantic interest regarding X.
        > in practice, such f can be 
            1: a classification function that assigns a label to X 
            2: a segmentation function that assigns a per point label to each member of M

Method
    > PointNet++ is basically an extension of PointNet with added hierarchical structure
    > As such, we first review PointNet, then introduce a basic extention of PointNet with hierichical strucutre, and finally propose PointNet++ that can robustly learn features even in non-uniformity sampled point sets

    1: Review of PointNet: A Universal Continuous Set Function Approximator
        - Given an unordered set of points {x_1 ... x_n} with x_i in R^d, one can define a set function F : X -> R that maps a set of points to a vector
            > f(x_1 ... x_n) = phi(MAX_[i = 1:n]{ h(x_i) }), where phi and h are MLPs 
            > set function is invariant to input point permutation and can arbitrarily approximate any continuous set function
            > Response of h(.) can be thought of as the spatial encodding of a point (PointNet)
    2: Hierarchical Point Set Feature Learning 
        > In PointNet, a single max pooling is used to aggregate the whole point set 
        > our new architecture builds a hierarchical grouping of points and progressively abstract larger and larger local regions along the hierarchy
            - this architecture is composed by a number of set abstraction levels 
            - At each level, a set of points is processed and abstracted to produce a new set with fewer elements 
            - The set abstraction level is made of 3 key elements:
                1: Smapling Layer
                    > this layer selects a set of points from input points, which defines the centroid of local regions 
                    > More formaly, given input point {x_1 ... x_n}, we use iterative farthest point sampling to choose a subset of points {x_i1 ... x_im}
                      such that x_ij is the most distant point (in metric distance) from set {x_i1 ... x_ij-1} with regards to the rest points 
                        - Compared with random sampling, it has better coverage of the entire point set given the same number of centroids 
                        - In contrast with CNNS that scan the vector sace agnostic of data distribution, this sampling strategy generates receptive fields 
                          in a data dependent manner 
                2: Grouping Later 
                    > this layer constructs local region sets by finding "neighboring" points around the centroids 
                    > 
                3: PointNet Layer 
                    > this layer uses a mini-PointNet to encode local region patterns into faeture vectors 
                * Potentially Non-Euc can be used to replace any of these 3 layers, maybe the PointNet layer 
            